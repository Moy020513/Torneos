{% extends 'torneos/base.html' %}
{% load custom_filters %}
{% block categoria_content %}
<div class="container mt-3 mt-lg-5 mb-4 mb-lg-5 px-2 px-lg-3">
    <!-- Hero Section con foto de perfil -->
    <div class="card shadow-lg border-0 mb-3 mb-lg-4 overflow-hidden">
        <div class="row g-0">
            <div class="col-lg-4 bg-gradient position-relative" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 200px;">
                <div class="d-flex align-items-center justify-content-center h-100 p-3 p-lg-4">
                {% if jugador.foto %}
                    <div class="text-center">
                        <img src="{{ jugador.foto.url }}" 
                            class="rounded-circle border border-3 border-lg-5 border-white shadow-lg mobile-avatar" 
                            alt="Foto de {{ jugador.nombre }}" 
                            style="width: 130px; height: 130px; object-fit: contain; image-rendering:auto; cursor:pointer;"
                            onclick="expandirFoto('{{ jugador.foto.url }}', '{{ jugador.nombre }} {{ jugador.apellido }}')">
                        {% if jugador.verificado %}
                            <div class="mt-2">
                                <span class="badge bg-success">VERIFICADO</span>
                            </div>
                        {% endif %}
                    </div>
                {% else %}
                    <div class="text-center">
                        <img src="/static/img/default_avatar.png" 
                            class="rounded-circle border border-3 border-lg-5 border-white shadow-lg mobile-avatar" 
                            alt="Sin foto" 
                            style="width: 130px; height: 130px; object-fit: contain; image-rendering:auto; cursor:pointer;"
                            onclick="expandirFoto('/static/img/default_avatar.png', 'Sin foto')">
                    </div>
                {% endif %}
                </div>
            </div>
            <div class="col-lg-8">
                <div class="card-body p-3 p-lg-5">
                    <div class="d-flex justify-content-between align-items-start mb-2 mb-lg-3">
                        <div class="flex-grow-1 me-2">
                            <h1 class="mobile-title fw-bold mb-1 mb-lg-2">{{ jugador.nombre }} {{ jugador.apellido }}</h1>
                            <p class="text-muted mobile-team mb-0">
                                
                                {% if jugador.equipo.logo %}
                                    <img src="{{ jugador.equipo.logo.url }}" alt="Logo {{ jugador.equipo.nombre }}" style="height:32px; width:auto; margin-right:6px; vertical-align:middle; object-fit:contain; border-radius:6px; background:#fff; border:1px solid #eee;">
                                {% endif %}
                                {{ jugador.equipo.nombre }}
                            </p>
                        </div>
                        <span class="badge bg-primary mobile-badge px-3 py-2" style="min-width: 50px;">
                            #{{ jugador.numero_camiseta }}
                        </span>
                    </div>
                    
                    <div class="row g-2 g-lg-4 mt-2 mt-lg-3">
                        <div class="col-6 col-md-6">
                            <div class="d-flex align-items-center">
                                <div class="bg-light rounded-circle mobile-icon-wrapper me-2 me-lg-3">
                                    <i class="bi bi-calendar3 text-primary mobile-icon"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mobile-label">Fecha de nacimiento</small>
                                    <strong class="mobile-value">{{ jugador.fecha_nacimiento|date:'d/m/Y' }}</strong>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-6">
                            <div class="d-flex align-items-center">
                                <div class="bg-light rounded-circle mobile-icon-wrapper me-2 me-lg-3">
                                    <i class="bi bi-hourglass-split text-success mobile-icon"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mobile-label">Edad</small>
                                    <strong class="mobile-value">{{ jugador.fecha_nacimiento|calcular_edad }} años</strong>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-6">
                            <div class="d-flex align-items-center">
                                <div class="bg-light rounded-circle mobile-icon-wrapper me-2 me-lg-3">
                                    <i class="bi bi-trophy text-warning mobile-icon"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mobile-label">Partidos jugados</small>
                                    <strong class="mobile-value">{{ jugador.participaciones.count }}</strong>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-6">
                            <div class="d-flex align-items-center">
                                <div class="bg-light rounded-circle mobile-icon-wrapper me-2 me-lg-3">
                                    <i class="bi bi-person-badge text-info mobile-icon"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mobile-label">Posición</small>
                                    <strong class="mobile-value">{{ jugador.get_posicion_display }}</strong>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-md-6">
                            <div class="d-flex align-items-center">
                                <div class="bg-light rounded-circle mobile-icon-wrapper me-2 me-lg-3">
                                    <i class="bi bi-people-fill text-secondary mobile-icon"></i>
                                </div>
                                <div>
                                    <small class="text-muted d-block mobile-label">Fecha de registro</small>
                                    <strong class="mobile-value">{{ jugador.fecha_creacion|date:'d/m/Y H:i' }}</strong>
                                </div>
                            </div>
                        </div>  
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sección de Participaciones -->
    <div class="card shadow-sm border-0">
        <div class="card-header bg-white border-0 pt-3 pt-lg-4 pb-2 pb-lg-3 px-3 px-lg-4">
            <div class="d-flex align-items-center justify-content-between">
                <h4 class="mb-0 fw-bold mobile-section-title">
                    <i class="bi bi-list-check me-1 me-lg-2 text-primary"></i>Historial de Participaciones
                </h4>
                <span class="badge bg-light text-dark mobile-count-badge">{{ participaciones|length }}</span>
            </div>
        </div>
        <div class="card-body p-0">
            {% if participaciones %}
                <div class="list-group list-group-flush">
                    {% for participacion in participaciones %}
                        <div class="list-group-item list-group-item-action border-0 py-2 py-lg-3 px-3 px-lg-4 hover-shadow transition">
                            <div class="d-flex justify-content-between align-items-start">
                                <div class="flex-grow-1 me-2">
                                    <h6 class="mb-1 mb-lg-2 fw-semibold mobile-match-title">{{ participacion.partido }}</h6>
                                    <div class="d-flex align-items-center text-muted">
                                        <i class="bi bi-calendar-event me-1 mobile-icon-small"></i>
                                        <small class="mobile-date">{{ participacion.partido.fecha|date:'d/m/Y H:i' }}</small>
                                    </div>
                                </div>
                                <div class="text-end">
                                    <span class="badge bg-light text-dark mobile-time-badge">
                                        <i class="bi bi-clock-history me-1"></i>{{ participacion.partido.fecha|date:'H:i' }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-4 py-lg-5">
                    <i class="bi bi-inbox mobile-empty-icon text-muted"></i>
                    <p class="text-muted mt-2 mt-lg-3 mobile-empty-text">No hay participaciones registradas</p>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Botón de retorno -->
    <div class="mt-3 mt-lg-4">
        <a href="javascript:history.back()" class="btn btn-outline-secondary mobile-back-btn px-3 px-lg-4">
            <i class="bi bi-arrow-left me-2"></i>Volver
        </a>
    </div>
</div>

<style>
    /* Estilos móviles por defecto */
    .mobile-avatar {
        width: 130px !important;
        height: 130px !important;
    }
    
    .mobile-title {
        font-size: 1.25rem;
        line-height: 1.3;
    }
    
    .mobile-team {
        font-size: 0.85rem;
    }
    
    .mobile-badge {
        font-size: 0.95rem;
        padding: 0.4rem 0.7rem !important;
        min-width: 50px !important;
    }
    
    .mobile-icon-wrapper {
        padding: 0.5rem;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .mobile-icon {
        font-size: 0.95rem;
    }
    
    .mobile-label {
        font-size: 0.7rem;
        line-height: 1.2;
    }
    
    .mobile-value {
        font-size: 0.85rem;
    }
    
    .mobile-section-title {
        font-size: 1rem;
    }
    
    .mobile-count-badge {
        font-size: 0.75rem;
        padding: 0.3rem 0.6rem;
    }
    
    .mobile-match-title {
        font-size: 0.9rem;
        line-height: 1.3;
    }
    
    .mobile-date {
        font-size: 0.75rem;
    }
    
    .mobile-icon-small {
        font-size: 0.85rem;
    }
    
    .mobile-time-badge {
        font-size: 0.7rem;
        padding: 0.25rem 0.5rem;
    }
    
    .mobile-empty-icon {
        font-size: 3rem;
    }
    
    .mobile-empty-text {
        font-size: 0.85rem;
    }
    
    .mobile-back-btn {
        font-size: 0.9rem;
        padding: 0.5rem 1rem !important;
    }
    
    /* Estilos para escritorio (lg y superior) */
    @media (min-width: 992px) {
        .mobile-avatar {
            width: 200px !important;
            height: 200px !important;
        }
        
        .mobile-title {
            font-size: 2.5rem;
        }
        
        .mobile-team {
            font-size: 1.25rem;
        }
        
        .mobile-badge {
            font-size: 1.5rem;
            padding: 0.75rem 1rem !important;
            min-width: 70px !important;
        }
        
        .mobile-icon-wrapper {
            padding: 0.75rem;
            width: 48px;
            height: 48px;
        }
        
        .mobile-icon {
            font-size: 1.25rem;
        }
        
        .mobile-label {
            font-size: 0.875rem;
        }
        
        .mobile-value {
            font-size: 1rem;
        }
        
        .mobile-section-title {
            font-size: 1.5rem;
        }
        
        .mobile-count-badge {
            font-size: 0.875rem;
            padding: 0.375rem 0.75rem;
        }
        
        .mobile-match-title {
            font-size: 1.1rem;
        }
        
        .mobile-date {
            font-size: 0.875rem;
        }
        
        .mobile-icon-small {
            font-size: 1rem;
        }
        
        .mobile-time-badge {
            font-size: 0.875rem;
            padding: 0.375rem 0.75rem;
        }
        
        .mobile-empty-icon {
            font-size: 6rem;
        }
        
        .mobile-empty-text {
            font-size: 1rem;
        }
        
        .mobile-back-btn {
            font-size: 1.1rem;
            padding: 0.75rem 1.5rem !important;
        }
    }
    
    .hover-shadow {
        transition: all 0.3s ease;
    }
    
    .hover-shadow:hover {
        background-color: #f8f9fa;
        transform: translateX(5px);
    }
    
    .bg-gradient {
        position: relative;
    }
    
    .bg-gradient::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
    }
</style>

<!-- Modal para expandir la foto en la vista de detalle -->
<div class="modal fade" id="fotoModalDetalle" tabindex="-1" aria-labelledby="fotoModalDetalleLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content" style="background: linear-gradient(135deg, #0a2342 0%, #1a365d 100%); border: 2px solid #08F7FE;">
            <div class="modal-header border-bottom" style="border-color: #08F7FE !important;">
                <h5 class="modal-title text-white" id="fotoModalDetalleLabel">Foto del Jugador</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <img id="fotoExpandidaDetalle" src="" alt="" class="img-fluid rounded" style="max-height: 70vh; object-fit: contain;">
            </div>
        </div>
    </div>
</div>

<script>
    function expandirFoto(urlFoto, nombreJugador) {
        var img = document.getElementById('fotoExpandidaDetalle');
        img.src = urlFoto;
        img.alt = nombreJugador;
        document.getElementById('fotoModalDetalleLabel').textContent = nombreJugador;
        var modal = new bootstrap.Modal(document.getElementById('fotoModalDetalle'));
        modal.show();
    }
</script>

<!-- Asegúrate de incluir Bootstrap Icons en tu base.html -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"> -->
{% endblock %}