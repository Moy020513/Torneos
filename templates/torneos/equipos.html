{% extends 'torneos/base.html' %}
{% block categoria_content %}
    <div class="row mb-3">
        <div class="col-12">
            <div class="d-flex align-items-center justify-content-between mt-2">
                <div class="text-light">
                    <strong>Total de equipos:</strong> <span id="total-equipos">{{ equipos|length }}</span>
                </div>
                <div class="d-flex align-items-center gap-2">
                    <input type="text" id="buscador-equipos" class="form-control" placeholder="Buscar equipo..." style="max-width: 220px;">
                </div>
            </div>
        </div>
    </div>
    <div class="d-flex flex-wrap justify-content-center gap-3" id="equipos-lista">
        {% for equipo in equipos %}
        <div class="equipo-item">
            <div class="card" style="width: max-content; min-width: 200px; max-width: 300px;">
                <div class="card-body">
                    <div class="d-flex flex-column align-items-center mb-2">
                        {% if equipo.logo %}
                            <img src="{{ equipo.logo.url }}" alt="{{ equipo.nombre }}" style="width:40px; height:40px; object-fit:contain; margin-bottom:10px;">
                        {% endif %}
                        <h5 class="card-title mb-0 nombre-equipo">{{ equipo.nombre }}</h5>
                    </div>
                    <p class="card-text">
                        <strong>Capitán:</strong> {% if equipo.capitan %}{{ equipo.capitan.usuario.get_full_name|default:equipo.capitan.usuario.username }}{% else %}Sin capitán{% endif %}<br>
                        <strong>Jugadores:</strong> {{ equipo.jugador_set.count }}<br>
                        <strong>Color:</strong> <span style="color: {{ equipo.color }}; font-weight: bold;">{{ equipo.color }}</span>
                    </p>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="alert alert-info">No hay equipos registrados en esta categoría.</div>
        </div>
        {% endfor %}
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const buscador = document.getElementById('buscador-equipos');
        const equipos = document.querySelectorAll('.equipo-item');
        const totalSpan = document.getElementById('total-equipos');
        buscador.addEventListener('input', function() {
            let count = 0;
            equipos.forEach(function(item) {
                const nombre = item.querySelector('.nombre-equipo').textContent.toLowerCase();
                if (nombre.includes(buscador.value.toLowerCase())) {
                    item.style.display = '';
                    count++;
                } else {
                    item.style.display = 'none';
                }
            });
            totalSpan.textContent = count;
        });
    });
    </script>
{% endblock %}
